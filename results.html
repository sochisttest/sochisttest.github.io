<head>
<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,700|Roboto:400,700" rel="stylesheet">
<link href='style.css' rel='stylesheet' type='text/css'>
<title>Socialist History Test Results</title>
<link rel="icon" type="x-icon" href="icon.png">
<link rel="shortcut icon" type="x-icon" href="icon.png">
<meta charset="utf-8">
<script>
  version = "v1.3" //Remember to update this before making changes to the test itself!
</script>
</head>
<script type="application/javascript"
        src="ideologies.js">
</script>

<body>
<h1>Socialist History Test</h1>
<hr>

<h1>Results</h1>

<h2>Closest Match: <span class="weight-300" id="ideology-label"></span></h2>
<p>You can send these results by copying and pasting the URL at the top of the page or using the image below. </p>
<img src="" id="banner">

<hr>

<h2>Revolutionary Class: <span class="weight-300" id="proletarian-label"></span></h2>
<div class="axis">
    <img id="img-proletarian" src="value_images/proletarian.png" height="70pt"/>
    <div class="bar proletarian" id="bar-proletarian"><div class="text-wrapper" id="proletarian"></div></div>
    <div class="bar agrarian" id="bar-agrarian"><div class="text-wrapper" id="agrarian"></div></div>
    <img id="img-agrarian" src="value_images/agrarian.png" height="70pt"/>
</div>
<h2>Relationship to the State: <span class="weight-300" id="state-dependent-label"></span></h2>
<div class="axis">
    <img id="img-state-dependent" src="value_images/state-dependent.png" height="70pt"/>
    <div class="bar state-dependent" id="bar-state-dependent"><div class="text-wrapper" id="state-dependent"></div></div>
    <div class="bar state-independent" id="bar-state-independent"><div class="text-wrapper" id="state-independent"></div></div>
    <img id="img-state-independent" src="value_images/state-independent.png" height="70pt"/>
</div>
<h2>Scope of Activity: <span class="weight-300" id="economistic-label"></span></h2>
<div class="axis">
    <img id="img-economistic" src="value_images/economistic.png" height="70pt"/>
    <div class="bar economistic" id="bar-economistic"><div class="text-wrapper" id="economistic"></div></div>
    <div class="bar comprehensive" id="bar-comprehensive"><div class="text-wrapper" id="comprehensive"></div></div>
    <img id="img-comprehensive" src="value_images/comprehensive.png" height="70pt"/>
</div>
<h2>Style of Organization: <span class="weight-300" id="pro-party-label"></span></h2>
<div class="axis">
    <img id="img-pro-party" src="value_images/pro-party.png" height="70pt"/>
    <div class="bar pro-party" id="bar-pro-party"><div class="text-wrapper" id="pro-party"></div></div>
    <div class="bar anti-party" id="bar-anti-party"><div class="text-wrapper" id="anti-party"></div></div>
    <img id="img-anti-party" src="value_images/anti-party.png" height="70pt"/>
</div>
<h2>National Strategy: <span class="weight-300" id="international-label"></span></h2>
<div class="axis">
    <img id="img-international" src="value_images/international.png" height="70pt"/>
    <div class="bar international" id="bar-international"><div class="text-wrapper" id="international"></div></div>
    <div class="bar national" id="bar-national"><div class="text-wrapper" id="national"></div></div>
    <img id="img-national" src="value_images/national.png" height="70pt"/>
</div>
<h2>Lessons of October: <span class="weight-300" id="bolshevik-label"></span></h2>
<div class="axis">
    <img id="img-menshevik" src="value_images/menshevik.png" height="70pt"/>
    <div class="bar menshevik" id="bar-menshevik"><div class="text-wrapper" id="menshevik"></div></div>
    <div class="bar bolshevik" id="bar-bolshevik"><div class="text-wrapper" id="bolshevik"></div></div>
    <img id="img-bolshevik" src="value_images/bolshevik.png" height="70pt"/>
</div>
<h2>Post-Revolutionary Direction: <span class="weight-300" id="left-com-label"></span></h2>
<div class="axis">
    <img id="img-left-com" src="value_images/left-com.png" height="70pt"/>
    <div class="bar left-com" id="bar-left-com"><div class="text-wrapper" id="left-com"></div></div>
    <div class="bar right-com" id="bar-right-com"><div class="text-wrapper" id="right-com"></div></div>
    <img id="img-right-com" src="value_images/right-com.png" height="70pt"/>
</div>
<h2>Revolutionary Heirs: <span class="weight-300" id="stalin-label"></span></h2>
<div class="axis">
    <img id="img-stalin" src="value_images/stalin.png" height="70pt"/>
    <div class="bar stalin" id="bar-stalin"><div class="text-wrapper" id="stalin"></div></div>
    <div class="bar trotsky" id="bar-trotsky"><div class="text-wrapper" id="trotsky"></div></div>
    <img id="img-trotsky" src="value_images/trotsky.png" height="70pt"/>
</div>
<h2>Soviet Bloc: <span class="weight-300" id="pro-soviet-label"></span></h2>
<div class="axis">
    <img id="img-pro-soviet" src="value_images/pro-soviet.png" height="70pt"/>
    <div class="bar pro-soviet" id="bar-pro-soviet"><div class="text-wrapper" id="pro-soviet"></div></div>
    <div class="bar anti-soviet" id="bar-anti-soviet"><div class="text-wrapper" id="anti-soviet"></div></div>
    <img id="img-anti-soviet" src="value_images/anti-soviet.png" height="70pt"/>
</div>
<h2>Left Unity: <span class="weight-300" id="cooperating-label"></span></h2>
<div class="axis">
    <img id="img-cooperating" src="value_images/cooperating.png" height="70pt"/>
    <div class="bar cooperating" id="bar-cooperating"><div class="text-wrapper" id="cooperating"></div></div>
    <div class="bar splitting" id="bar-splitting"><div class="text-wrapper" id="splitting"></div></div>
    <img id="img-splitting" src="value_images/splitting.png" height="70pt"/>
</div>
<h2>The Ends: <span class="weight-300" id="radical-ends-label"></span></h2>
<div class="axis">
    <img id="img-radical-ends" src="value_images/radical-ends.png" height="70pt"/>
    <div class="bar radical-ends" id="bar-radical-ends"><div class="text-wrapper" id="radical-ends"></div></div>
    <div class="bar moderate-ends" id="bar-moderate-ends"><div class="text-wrapper" id="moderate-ends"></div></div>
    <img id="img-moderate-ends" src="value_images/moderate-ends.png" height="70pt"/>
</div>

<button class="button" onclick="location.href='index.html';">Back</button> <br>
<script>
    function getQueryVariable(variable)
    {
           var query = window.location.search.substring(1)
           var vars = query.split("&")
           for (var i=0;i<vars.length;i++) {
                   var pair = vars[i].split("=")
                   if(pair[0] == variable) {return pair[1]}
           }
           return(NaN);
    }

    function setBarValue(name, value) {
        innerel = document.getElementById(name)
        outerel = document.getElementById("bar-" + name)
        outerel.style.width = (value + "%")
        innerel.innerHTML = (value + "%")
        if (innerel.offsetWidth + 20 > outerel.offsetWidth) {
            innerel.style.visibility = "hidden"
        }
    }

    ussrArray = ["Pro-Soviet","Critical Support","Neutral","Conditional Opposition","Anti-Soviet"]
    prolArray = ["The Proletariat","The People","The People","The People","The Peasants"]
    statArray = ["Become the State","Use or Ignore the State","Neutral","Subjugate the State","Abolish It"]
    econArray = ["Economic Interests Only", "Economic Interests Prioritized", "Economic Interests Prioritized", "Base Before Superstructure", "Everything Existing"]
    prtyArray = ["Party Primacy","Prefers Parties", "Prefers Parties", "Prefers Unions", "Direct Action"]
    intlArray = ["International Organization","International Fraternity","International Fraternity","International Fraternity","National Organization"]
    coopArray = ["Popular Front", "Tactical Unity", "Tactical Unity", "Tactical Unity", "Sectarian"]
    bolsArray = ["Permanent Revolution", "Revolutionary Coalition", "Neutral", "Two-Stage Revolution", "Reformism"]
    lcomArray = ["Ultra-Left Advance", "Tactical Advance", "Neutral", "Tactical Retreat", "Market Reform"]
    stalArray = ["Stalinist Outlook", "Some Stalinist Tendencies", "Neutral", "Some Trotskyist Tendencies", "Trotskyist Outlook"]
    radcArray = ["Abolish Labor", "Redistribute Wealth", "Redistribute Wealth", "Redistribute Wealth", "Improve Welfare"]

    function setLabel(val,ary) {
        if (val > 100) { return "" } else
        if (val >= 75) { return ary[0] } else
        if (val >= 50.5) { return ary[1] } else
        if (val >= 49.5) { return ary[2] } else
        if (val >= 25) { return ary[3] } else
        if (val >= 0) { return ary[4] } else
        	{return ""}
    }

    pro_soviet = getQueryVariable("u")
    proletarian = getQueryVariable("p")
    state_dependent = getQueryVariable("t")
    economistic = getQueryVariable("e")
    pro_party = getQueryVariable("y")
    international = getQueryVariable("i")
    cooperating = getQueryVariable("c")
    bolshevik = getQueryVariable("b")
    left_com = getQueryVariable("l")
    stalin = getQueryVariable("s")
    radical_ends = getQueryVariable("r")
    anti_soviet = (100 - pro_soviet).toFixed(1)
    agrarian = (100 - proletarian).toFixed(1)
    state_independent = (100 - state_dependent).toFixed(1)
    comprehensive = (100 - economistic).toFixed(1)
    anti_party = (100 - pro_party).toFixed(1)
    national = (100 - international).toFixed(1)
    splitting = (100 - cooperating).toFixed(1)
    menshevik = (100 - bolshevik).toFixed(1)
    right_com = (100 - left_com).toFixed(1)
    trotsky = (100 - stalin).toFixed(1)
    moderate_ends = (100 - radical_ends).toFixed(1)

    document.getElementById("pro-soviet-label").innerHTML = setLabel(pro_soviet, ussrArray)
    document.getElementById("proletarian-label").innerHTML = setLabel(proletarian, prolArray)
    document.getElementById("state-dependent-label").innerHTML = setLabel(state_dependent, statArray)
    document.getElementById("economistic-label").innerHTML = setLabel(economistic, econArray)
    document.getElementById("pro-party-label").innerHTML = setLabel(pro_party, prtyArray)
    document.getElementById("international-label").innerHTML = setLabel(international, intlArray)
    document.getElementById("cooperating-label").innerHTML = setLabel(cooperating, coopArray)
    document.getElementById("bolshevik-label").innerHTML = setLabel(bolshevik, bolsArray)
    document.getElementById("left-com-label").innerHTML = setLabel(left_com, lcomArray)
    document.getElementById("stalin-label").innerHTML = setLabel(stalin, stalArray)
    document.getElementById("radical-ends-label").innerHTML = setLabel(radical_ends, radcArray)

    setBarValue("pro-soviet", pro_soviet)
    setBarValue("proletarian", proletarian)
    setBarValue("state-dependent", state_dependent)
    setBarValue("economistic", economistic)
    setBarValue("pro-party", pro_party)
    setBarValue("international", international)
    setBarValue("cooperating", cooperating)
    setBarValue("bolshevik", bolshevik)
    setBarValue("left-com", left_com)
    setBarValue("stalin", stalin)
    setBarValue("radical-ends", radical_ends)
    setBarValue("anti-soviet", anti_soviet)
    setBarValue("agrarian", agrarian)
    setBarValue("state-independent", state_independent)
    setBarValue("comprehensive", comprehensive)
    setBarValue("anti-party", anti_party)
    setBarValue("national", national)
    setBarValue("splitting", splitting)
    setBarValue("menshevik", menshevik)
    setBarValue("right-com", right_com)
    setBarValue("trotsky", trotsky)
    setBarValue("moderate-ends", moderate_ends)

    ideology = ""
    ideodist = Infinity
    for (var i = 0; i < ideologies.length; i++) {
        dist = 0
        dist += Math.pow(Math.abs(ideologies[i].stats.ussr - pro_soviet), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.prol - proletarian), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.stat - state_dependent), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.econ - economistic), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.prty - pro_party), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.intl - international), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.coop - cooperating), 1)
        dist += Math.pow(Math.abs(ideologies[i].stats.bols - bolshevik), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.lcom - left_com), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.stal - stalin), 2)
        dist += Math.pow(Math.abs(ideologies[i].stats.radc - radical_ends), 2)
        if (dist < ideodist) {
            ideology = ideologies[i].name
            ideodist = dist
        }
    }
    document.getElementById("ideology-label").innerHTML = ideology

    function createImage(src, x, y, w, h) {
        img = new Image ()
        img.src = src
        img.onLoad = function() {
            ctx.drawImage(img, x, y, w, h)
        }
    }

    window.onload = function() {
        var c = document.createElement("canvas")
        var ctx = c.getContext("2d")
        c.width = 800;
        c.height = 900;
        ctx.fillStyle = "#EEEEEE"
        ctx.fillRect(0,0,800,900);

        img = document.getElementById("img-proletarian")
        ctx.drawImage(img, 20, 170, 100, 55)
        img = document.getElementById("img-agrarian")
        ctx.drawImage(img, 680, 170, 100, 55)
        img = document.getElementById("img-state-dependent")
        ctx.drawImage(img, 20, 230, 100, 55)
        img = document.getElementById("img-state-independent")
        ctx.drawImage(img, 680, 230, 100, 55)
        img = document.getElementById("img-economistic")
        ctx.drawImage(img, 20, 290, 100, 55)
        img = document.getElementById("img-comprehensive")
        ctx.drawImage(img, 680, 290, 100, 55)
        img = document.getElementById("img-pro-party")
        ctx.drawImage(img, 20, 350, 100, 55)
        img = document.getElementById("img-anti-party")
        ctx.drawImage(img, 680, 350, 100, 55)
        img = document.getElementById("img-international")
        ctx.drawImage(img, 20, 410, 100, 55)
        img = document.getElementById("img-national")
        ctx.drawImage(img, 680, 410, 100, 55)
        img = document.getElementById("img-menshevik")
        ctx.drawImage(img, 20, 470, 100, 55)
        img = document.getElementById("img-bolshevik")
        ctx.drawImage(img, 680, 470, 100, 55)
        img = document.getElementById("img-left-com")
        ctx.drawImage(img, 20, 530, 100, 55)
        img = document.getElementById("img-right-com")
        ctx.drawImage(img, 680, 530, 100, 55)
        img = document.getElementById("img-stalin")
        ctx.drawImage(img, 20, 590, 100, 55)
        img = document.getElementById("img-trotsky")
        ctx.drawImage(img, 680, 590, 100, 55)
        img = document.getElementById("img-pro-soviet")
        ctx.drawImage(img, 20, 650, 100, 55)
        img = document.getElementById("img-anti-soviet")
        ctx.drawImage(img, 680, 650, 100, 55)
        img = document.getElementById("img-cooperating")
        ctx.drawImage(img, 20, 710, 100, 55)
        img = document.getElementById("img-splitting")
        ctx.drawImage(img, 680, 710, 100, 55)
        img = document.getElementById("img-radical-ends")
        ctx.drawImage(img, 20, 770, 100, 55)
        img = document.getElementById("img-moderate-ends")
        ctx.drawImage(img, 680, 770, 100, 55)

        ctx.fillStyle="#222222"
        ctx.fillRect(120, 180, 560, 30)
        ctx.fillRect(120, 240, 560, 30)
        ctx.fillRect(120, 300, 560, 30)
        ctx.fillRect(120, 360, 560, 30)
        ctx.fillRect(120, 420, 560, 30)
        ctx.fillRect(120, 480, 560, 30)
        ctx.fillRect(120, 540, 560, 30)
        ctx.fillRect(120, 600, 560, 30)
        ctx.fillRect(120, 660, 560, 30)
        ctx.fillRect(120, 720, 560, 30)
        ctx.fillRect(120, 780, 560, 30)
        ctx.fillStyle="#ff5ac4"
        ctx.fillRect(120, 184, 5.6*proletarian-2, 22)
        ctx.fillStyle="#a8ff00"
        ctx.fillRect(682-5.6*agrarian, 184, 5.6*agrarian-2, 22)
        ctx.fillStyle="#b25aff"
        ctx.fillRect(120, 244, 5.6*state_dependent-2, 22)
        ctx.fillStyle="#fff75c"
        ctx.fillRect(682-5.6*state_independent, 244, 5.6*state_independent-2, 22)
        ctx.fillStyle="#675fff"
        ctx.fillRect(120, 304, 5.6*economistic-2, 22)
        ctx.fillStyle="#ffbf61"
        ctx.fillRect(682-5.6*comprehensive, 304, 5.6*comprehensive-2, 22)
        ctx.fillStyle="#66beff"
        ctx.fillRect(120, 364, 5.6*pro_party-2, 22)
        ctx.fillStyle="#ff9166"
        ctx.fillRect(682-5.6*anti_party, 364, 5.6*anti_party-2, 22)
        ctx.fillStyle="#66ffec"
        ctx.fillRect(120, 424, 5.6*international-2, 22)
        ctx.fillStyle="#ff6666"
        ctx.fillRect(682-5.6*national, 424, 5.6*national-2, 22)
        ctx.fillStyle="#66ff91"
        ctx.fillRect(120, 484, 5.6*menshevik-2, 22)
        ctx.fillStyle="#ff66d0"
        ctx.fillRect(682-5.6*bolshevik, 484, 5.6*bolshevik-2, 22)
        ctx.fillStyle="#bcff66"
        ctx.fillRect(120, 544, 5.6*left_com-2, 22)
        ctx.fillStyle="#b466ff"
        ctx.fillRect(682-5.6*right_com, 544, 5.6*right_com-2, 22)
        ctx.fillStyle="#fffb66"
        ctx.fillRect(120, 604, 5.6*stalin-2, 22)
        ctx.fillStyle="#6a66ff"
        ctx.fillRect(682-5.6*trotsky, 604, 5.6*trotsky-2, 22)
        ctx.fillStyle="#ffbd66"
        ctx.fillRect(120, 664, 5.6*pro_soviet-2, 22)
        ctx.fillStyle="#66b3ff"
        ctx.fillRect(682-5.6*anti_soviet, 664, 5.6*anti_soviet-2, 22)
        ctx.fillStyle="#ff9966"
        ctx.fillRect(120, 724, 5.6*cooperating-2, 22)
        ctx.fillStyle="#66ffff"
        ctx.fillRect(682-5.6*splitting, 724, 5.6*splitting-2, 22)
        ctx.fillStyle="#ff6666"
        ctx.fillRect(120, 784, 5.6*radical_ends-2, 22)
        ctx.fillStyle="#66ffa4"
        ctx.fillRect(682-5.6*moderate_ends, 784, 5.6*moderate_ends-2, 22)

        ctx.fillStyle="#222222"
        ctx.font="700 30px Montserrat"
        ctx.textAlign="left"
        ctx.fillText("Socialist History Values Test", 20, 100)
        ctx.font="20px Montserrat"
        ctx.fillText("sochisttest.github.io", 20, 65)
        ctx.fillText("Closest match: "+ideology, 20, 140)

        ctx.textAlign="left"
        if (proletarian > 30) {ctx.fillText(proletarian + "%", 130, 202)}
        if (state_dependent > 30) {ctx.fillText(state_dependent + "%", 130, 262)}
        if (economistic > 30) {ctx.fillText(economistic + "%", 130, 322)}
        if (pro_party > 30) {ctx.fillText(pro_party + "%", 130, 382)}
        if (international > 30) {ctx.fillText(international + "%", 130, 442)}
        if (menshevik > 30) {ctx.fillText(menshevik + "%", 130, 502)}
        if (left_com > 30) {ctx.fillText(left_com + "%", 130, 562)}
        if (stalin > 30) {ctx.fillText(stalin + "%", 130, 622)}
        if (pro_soviet > 30) {ctx.fillText(pro_soviet + "%", 130, 682)}
        if (cooperating > 30) {ctx.fillText(cooperating + "%", 130, 742)}
        if (radical_ends > 30) {ctx.fillText(radical_ends + "%", 130, 802)}

        ctx.textAlign="right"
        if (agrarian > 30) {ctx.fillText(agrarian + "%", 670, 202)}
        if (state_independent > 30) {ctx.fillText(state_independent + "%", 670, 262)}
        if (comprehensive > 30) {ctx.fillText(comprehensive + "%", 670, 322)}
        if (anti_party > 30) {ctx.fillText(anti_party + "%", 670, 382)}
        if (national > 30) {ctx.fillText(national + "%", 670, 442)}
        if (bolshevik > 30) {ctx.fillText(bolshevik + "%", 670, 502)}
        if (right_com > 30) {ctx.fillText(right_com + "%", 670, 562)}
        if (trotsky > 30) {ctx.fillText(trotsky + "%", 670, 622)}
        if (anti_soviet > 30) {ctx.fillText(anti_soviet + "%", 670, 682)}
        if (splitting > 30) {ctx.fillText(splitting + "%", 670, 742)}
        if (moderate_ends > 30) {ctx.fillText(moderate_ends + "%", 670, 802)}

        ctx.font="300 30px Montserrat"
		ctx.fillText(version, 780, 90)

        ctx.textAlign="center"
        ctx.font="300 16px Montserrat bold"
        ctx.fillText("Revolutionary Class: " + document.getElementById("proletarian-label").innerHTML, 400, 175)
        ctx.fillText("Relationship to the State: " + document.getElementById("state-dependent-label").innerHTML, 400, 235)
        ctx.fillText("Scope of Activity: " + document.getElementById("economistic-label").innerHTML, 400, 295)
        ctx.fillText("Style of Organization: " + document.getElementById("pro-party-label").innerHTML, 400, 355)
        ctx.fillText("National Strategy: " + document.getElementById("international-label").innerHTML, 400, 415)
        ctx.fillText("Lessons of October: " + document.getElementById("bolshevik-label").innerHTML, 400, 475)
        ctx.fillText("Post-Revolutionary Direction: " + document.getElementById("left-com-label").innerHTML, 400, 535)
        ctx.fillText("Revolutionary Heirs: " + document.getElementById("stalin-label").innerHTML, 400, 595)
        ctx.fillText("Soviet Bloc: " + document.getElementById("pro-soviet-label").innerHTML, 400, 655)
        ctx.fillText("Left Unity: " + document.getElementById("cooperating-label").innerHTML, 400, 715)
        ctx.fillText("The Ends: " + document.getElementById("radical-ends-label").innerHTML, 400, 775)

        document.getElementById("banner").src = c.toDataURL();
    }
    </script>
</body>
